@model Bearchop.Areas.LOTW.Web.ViewModels.PicksViewModel


@{
    ViewBag.Title = "Picks for Week " + Model.PickWeek.Number.ToString();
}

@Html.Partial("_UserPicks", Model)

@section javascript
{
<script language="javascript" type="text/javascript">

    $(function () {

        removeActivePill();
        $('.picks').addClass('active');
    });

</script>
    
    <script language="javascript" type="text/javascript">

        $(function () {

            $(".selectedCheckbox").change(function () {
                checkboxEnable(this);
            });

            $(".pickList").change(function () {

                var index = $(this).attr('data-rowid');

                if (this.value == 2) {
                    $("#overUnderPick" + index).removeAttr('disabled');
                } else {
                    $("#overUnderPick" + index).attr('disabled', 'disabled');
                }
            });

            checkboxEnable(null);

        });

        function checkboxEnable(checkboxClicked) {
            if ($(".selectedCheckbox:checked").length == 3) {

                $(".selectedCheckbox:not(:checked)").each(function () {
                    $(this).parent().parent().find('*').attr('disabled', 'disabled')
                });
            }
            else {
                $(".selectedCheckbox:not(:checked)").each(function () {
                    $(this).parent().parent().find('*').removeAttr('disabled');
                    var index = $(this).attr('alt');
                    $(".pickList[data-rowid=" + index + "]").val(0);
                });
            }

            if (checkboxClicked != null) {

                var index = $(checkboxClicked).attr('alt');

                if (checkboxClicked.checked) {
                    $("[data-rowid=" + index + "][value='0']").attr("checked", "checked");
                } else {
                    $(".pickList[data-rowid=" + index + "]").val(0);
                }
            }
        }

        function enableAll() {
            $(":disabled").removeAttr("disabled");
        }

        function postForm() {

            enableAll();

            $.ajax({
                type: 'POST',
                url: $("#savePickForm").attr("action"),
                data: $("#savePickForm").serialize(),
                cache: false,
                success: function (result) {

                    var resp = result;
                    if (resp.Success == true) {
                        alert("Picks Saved");
                    } else {
                        alert("Error Saving Picks.  Please Contact Bradley");
                        $("#hiddenError").append(resp.Error);
                    }

                    checkboxEnable(null);
                }
            });
        }
    </script>

    
}